# NOTE Rules are framed for the Alertmanager API.
# FIXME wildcard these
rules:
  - name: AlertToDeployment
    start:
      domain: alert
    goal:
      domain: k8s
      classes: [Deployment.apps]
    result:
      query: |-
        { {{k8sQueryClass "Deployment.apps"}}, "Namespace": "{{.Alert.Labels.namespace}}", "Name":"{{.Alert.Labels.deployment}}"}

  - name: AlertToPod
    start:
      domain: alert
    goal:
      domain: k8s
      classes: [Pod.]
    result:
      query:  |-
        { {{k8sQueryClass "Pod"}}, "Namespace": "{{.Alert.Labels.namespace}}", "Name":"{{.Alert.Labels.pod}}"}

  - name: AlertToDaemonSet
    start:
      domain: alert
    goal:
      domain: k8s
      classes: [DaemonSet.apps]
    result:
      query:  |-
        { {{k8sQueryClass "DaemonSet.apps"}}, "Namespace": "{{.Alert.Labels.namespace}}", "Name":"{{.Alert.Labels.daemonset}}"}

  - name: AlertToStatefulSet
    start:
      domain: alert
    goal:
      domain: k8s
      classes: [StatefulSet.apps]
    result:
      query:  |-
        { {{k8sQueryClass "StatefulSet.apps"}}, "Namespace": "{{.Alert.Labels.namespace}}", "Name":"{{.Alert.Labels.statefulset}}"}
